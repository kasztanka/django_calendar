{% extends 'my_calendar/base.html' %}
{% block user_content %}
{% if date_errors %}
    <p>{{ date_errors }}</p>
{% endif %}
<a id="month" href="/month/{{ choosen_date|date:'Y-m-d' }}">Month</a>
<a id="week" href="/week/{{ choosen_date|date:'Y-m-d' }}">Week</a>
<a id="day" href="/day/{{ choosen_date|date:'Y-m-d' }}">1 day</a>
<div id="timeline" style="width:100%">
    <div id="header">
        <div>{{ choosen_date|date:"l m/d" }}</div>
    </div>
    <div id="all_day" style="float:left; width:100%; display:table;">
        <div style="display:table-cell;">
        All day:
        </div>
        {% for dict_ in days %}
            <div style="display:table-cell;width:95%">            
                {% for event in dict_.events %}
                    {% if event.all_day == True %}  
                    <a href="{% url 'my_calendar:event_view' event_pk=event.pk %}">
                        <div class="event"
                            id="event-{{ event.pk }}-{{ dict_.day|date:'Y/m/d' }}"
                            style="background-color:{{ event.color }};">
                            {{ event.title }}</div>
                    </a>
                    {% endif %}
                {% endfor %}
            </div>
        {% endfor %}
    </div>
    <div id="bottom" style="float:left; width:100%; display:table;">
        <div id="hours" style="display:table-cell;">
        {% for i in range %}
        <div>{{ i }}:00</div>
        {% endfor %}
        </div>
        <div id="events" style="position:relative; display:table-cell;width:95%">
            {% for dict_ in days %}
                {% for event in dict_.events %}
                    {% if event.all_day != True %} 
                    <a href="{% url 'my_calendar:event_view' event_pk=event.pk %}">
                        <div class="event" id="event-{{ event.pk }}"
                            style="position:absolute;
                            height:calc({{ event.height }} * 100%);
                            background-color:{{ event.color }};">
                            {{ event.title }}</div>
                    </a>
                    {% endif %}
                {% endfor %}
            {% endfor %}
        </div>
    </div>
</div>
<script>
var outer_height = $("#events").height();
var event;
{% for dict_ in days %}
    {% for event in dict_.events %}
        event = document.getElementById("event-{{ event.pk }}");
        event.style.top = outer_height * {{ event.top }} + "px";
    {% endfor %}
{% endfor %}
</script>
{% endblock %}